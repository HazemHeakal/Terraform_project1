{"format_version":"1.2","terraform_version":"1.9.6","variables":{"alb_idle_timeout":{"value":600},"alb_listener_port":{"value":"80"},"alb_listener_protocol":{"value":"HTTP"},"alb_name":{"value":"om-dev-us-east-1"},"alb_vpc_id":{"value":"vpc-04e46565bb5e772a5"},"asg_web_instance_name":{"value":"om-dev-use1-asg"},"aws_autoscaling_group_name":{"value":"OrderManager"},"aws_ssh_key_pair":{"value":"tillster-dev-us-east-1-keypair"},"lb_public_subnet_ids":{"value":["subnet-0e9e971b3973a6ea7","subnet-0010b6cc61b6e7c2c"]},"lb_security_group_id":{"value":["sg-0a7d75a49414ead24"]},"region":{"value":"us-east-1"},"tags":{"value":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"}},"web_instance_ami":{"value":"ami-0562851c7c2f478c5"},"web_instance_asg_group_cpu_scale_in_threshold_precentage":{"value":60},"web_instance_asg_group_cpu_scale_out_threshold_precentage":{"value":80},"web_instance_asg_max_instance_size":{"value":2},"web_instance_asg_min_instance_size":{"value":1},"web_instance_launch_template_name":{"value":"OrderManager-ASG"},"web_instance_scaling_adjustment":{"value":1},"web_instance_type":{"value":"t3.medium"},"web_private_subnet_ids":{"value":["subnet-022338a03b4a0dd31","subnet-02db307f14813ffd7"]},"web_security_group_id":{"value":["sg-0a7d75a49414ead24"]}},"planned_values":{"root_module":{"child_modules":[{"resources":[{"address":"module.alb.aws_lb.alb","mode":"managed","type":"aws_lb","name":"alb","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"access_logs":[],"client_keep_alive":3600,"connection_logs":[],"customer_owned_ipv4_pool":null,"desync_mitigation_mode":"defensive","dns_record_client_routing_policy":null,"drop_invalid_header_fields":false,"enable_cross_zone_load_balancing":null,"enable_deletion_protection":false,"enable_http2":true,"enable_tls_version_and_cipher_suite_headers":false,"enable_waf_fail_open":false,"enable_xff_client_port":false,"idle_timeout":60,"internal":false,"load_balancer_type":"application","name":"om-dev-us-east-1","preserve_host_header":false,"security_groups":["sg-0a7d75a49414ead24"],"subnets":["subnet-0010b6cc61b6e7c2c","subnet-0e9e971b3973a6ea7"],"tags":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"},"tags_all":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"},"timeouts":null,"xff_header_processing_mode":"append"},"sensitive_values":{"access_logs":[],"connection_logs":[],"security_groups":[false],"subnet_mapping":[],"subnets":[false,false],"tags":{},"tags_all":{}}},{"address":"module.alb.aws_lb_listener.alb_listener","mode":"managed","type":"aws_lb_listener","name":"alb_listener","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"alpn_policy":null,"certificate_arn":null,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[],"type":"forward"}],"port":80,"protocol":"HTTP","tags":null,"timeouts":null},"sensitive_values":{"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"mutual_authentication":[],"tags_all":{}}},{"address":"module.alb.aws_lb_target_group.alb_target_group","mode":"managed","type":"aws_lb_target_group","name":"alb_target_group","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"deregistration_delay":"300","health_check":[{"enabled":true,"healthy_threshold":3,"interval":30,"path":"/health","port":"traffic-port","protocol":"HTTP","timeout":5,"unhealthy_threshold":3}],"lambda_multi_value_headers_enabled":false,"name":"om-dev-us-east-1-tg","port":80,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"tags":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"},"tags_all":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"},"target_type":"instance","vpc_id":"vpc-04e46565bb5e772a5"},"sensitive_values":{"health_check":[{}],"load_balancer_arns":[],"stickiness":[],"tags":{},"tags_all":{},"target_failover":[],"target_group_health":[],"target_health_state":[]}},{"address":"module.alb.aws_lb_target_group_attachment.alb_target_group_attachment","mode":"managed","type":"aws_lb_target_group_attachment","name":"alb_target_group_attachment","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"availability_zone":null,"port":80},"sensitive_values":{}}],"address":"module.alb"},{"resources":[{"address":"module.web_instance_asg.aws_autoscaling_group.web_asg","mode":"managed","type":"aws_autoscaling_group","name":"web_asg","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"capacity_rebalance":null,"context":null,"default_instance_warmup":null,"desired_capacity":1,"desired_capacity_type":null,"enabled_metrics":null,"force_delete":false,"force_delete_warm_pool":false,"health_check_grace_period":300,"ignore_failed_scaling_activities":false,"initial_lifecycle_hook":[],"instance_maintenance_policy":[],"instance_refresh":[],"launch_configuration":null,"launch_template":[{"version":"$Latest"}],"max_instance_lifetime":null,"max_size":2,"metrics_granularity":"1Minute","min_elb_capacity":null,"min_size":1,"name":"OrderManager","placement_group":null,"protect_from_scale_in":false,"suspended_processes":null,"tag":[{"key":"Environment","propagate_at_launch":true,"value":"dev"},{"key":"Name","propagate_at_launch":true,"value":"om-dev-use1-asg"},{"key":"Platform","propagate_at_launch":true,"value":"tillster"},{"key":"Purpose","propagate_at_launch":true,"value":"om"},{"key":"Service","propagate_at_launch":true,"value":"om"},{"key":"Tenant","propagate_at_launch":true,"value":"shared"}],"termination_policies":null,"timeouts":null,"vpc_zone_identifier":["subnet-022338a03b4a0dd31","subnet-02db307f14813ffd7"],"wait_for_capacity_timeout":"10m","wait_for_elb_capacity":null,"warm_pool":[]},"sensitive_values":{"availability_zones":[],"initial_lifecycle_hook":[],"instance_maintenance_policy":[],"instance_refresh":[],"launch_template":[{}],"load_balancers":[],"mixed_instances_policy":[],"tag":[{},{},{},{},{},{}],"target_group_arns":[],"traffic_source":[],"vpc_zone_identifier":[false,false],"warm_pool":[]}},{"address":"module.web_instance_asg.aws_autoscaling_policy.scale_in_policy","mode":"managed","type":"aws_autoscaling_policy","name":"scale_in_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"adjustment_type":"ChangeInCapacity","autoscaling_group_name":"OrderManager","cooldown":null,"enabled":true,"estimated_instance_warmup":null,"min_adjustment_magnitude":null,"name":"scale-in-policy","policy_type":"SimpleScaling","predictive_scaling_configuration":[],"scaling_adjustment":-1,"step_adjustment":[],"target_tracking_configuration":[]},"sensitive_values":{"predictive_scaling_configuration":[],"step_adjustment":[],"target_tracking_configuration":[]}},{"address":"module.web_instance_asg.aws_autoscaling_policy.scale_out_policy","mode":"managed","type":"aws_autoscaling_policy","name":"scale_out_policy","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"adjustment_type":"ChangeInCapacity","autoscaling_group_name":"OrderManager","cooldown":null,"enabled":true,"estimated_instance_warmup":null,"min_adjustment_magnitude":null,"name":"scale-out-policy","policy_type":"SimpleScaling","predictive_scaling_configuration":[],"scaling_adjustment":1,"step_adjustment":[],"target_tracking_configuration":[]},"sensitive_values":{"predictive_scaling_configuration":[],"step_adjustment":[],"target_tracking_configuration":[]}},{"address":"module.web_instance_asg.aws_cloudwatch_metric_alarm.cpu_scale_in_alarm","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"cpu_scale_in_alarm","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_description":null,"alarm_name":"cpu-scale-in-alarm","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"AutoScalingGroupName":"OrderManager"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"CPUUtilization","metric_query":[],"namespace":"AWS/EC2","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":60,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"sensitive_values":{"alarm_actions":[],"dimensions":{},"metric_query":[],"tags_all":{}}},{"address":"module.web_instance_asg.aws_cloudwatch_metric_alarm.cpu_scale_out_alarm","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"cpu_scale_out_alarm","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":1,"values":{"actions_enabled":true,"alarm_description":null,"alarm_name":"cpu-scale-out-alarm","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"AutoScalingGroupName":"OrderManager"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"CPUUtilization","metric_query":[],"namespace":"AWS/EC2","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":80,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"sensitive_values":{"alarm_actions":[],"dimensions":{},"metric_query":[],"tags_all":{}}},{"address":"module.web_instance_asg.aws_launch_template.web_instance_launch_template","mode":"managed","type":"aws_launch_template","name":"web_instance_launch_template","provider_name":"registry.terraform.io/hashicorp/aws","schema_version":0,"values":{"block_device_mappings":[],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"description":null,"disable_api_stop":null,"disable_api_termination":null,"ebs_optimized":null,"elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[],"image_id":"ami-0562851c7c2f478c5","instance_initiated_shutdown_behavior":null,"instance_market_options":[],"instance_requirements":[],"instance_type":"t3.medium","kernel_id":null,"key_name":"tillster-dev-us-east-1-keypair","license_specification":[],"maintenance_options":[],"monitoring":[],"name_prefix":"OrderManager-ASG","network_interfaces":[{"associate_carrier_ip_address":null,"associate_public_ip_address":"false","delete_on_termination":null,"description":null,"device_index":null,"interface_type":null,"ipv4_address_count":null,"ipv4_addresses":null,"ipv4_prefix_count":null,"ipv4_prefixes":null,"ipv6_address_count":null,"ipv6_addresses":null,"ipv6_prefix_count":null,"ipv6_prefixes":null,"network_card_index":null,"network_interface_id":null,"primary_ipv6":null,"private_ip_address":null,"security_groups":["sg-0a7d75a49414ead24"],"subnet_id":null}],"placement":[],"private_dns_name_options":[],"ram_disk_id":null,"security_group_names":null,"tag_specifications":[{"resource_type":"instance","tags":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"}}],"tags":null,"update_default_version":null,"user_data":null,"vpc_security_group_ids":null},"sensitive_values":{"block_device_mappings":[],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[],"instance_market_options":[],"instance_requirements":[],"license_specification":[],"maintenance_options":[],"metadata_options":[],"monitoring":[],"network_interfaces":[{"security_groups":[false]}],"placement":[],"private_dns_name_options":[],"tag_specifications":[{"tags":{}}],"tags_all":{}}}],"address":"module.web_instance_asg"}]}},"resource_changes":[{"address":"module.alb.aws_lb.alb","module_address":"module.alb","mode":"managed","type":"aws_lb","name":"alb","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"access_logs":[],"client_keep_alive":3600,"connection_logs":[],"customer_owned_ipv4_pool":null,"desync_mitigation_mode":"defensive","dns_record_client_routing_policy":null,"drop_invalid_header_fields":false,"enable_cross_zone_load_balancing":null,"enable_deletion_protection":false,"enable_http2":true,"enable_tls_version_and_cipher_suite_headers":false,"enable_waf_fail_open":false,"enable_xff_client_port":false,"idle_timeout":60,"internal":false,"load_balancer_type":"application","name":"om-dev-us-east-1","preserve_host_header":false,"security_groups":["sg-0a7d75a49414ead24"],"subnets":["subnet-0010b6cc61b6e7c2c","subnet-0e9e971b3973a6ea7"],"tags":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"},"tags_all":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"},"timeouts":null,"xff_header_processing_mode":"append"},"after_unknown":{"access_logs":[],"arn":true,"arn_suffix":true,"connection_logs":[],"dns_name":true,"enforce_security_group_inbound_rules_on_private_link_traffic":true,"id":true,"ip_address_type":true,"name_prefix":true,"security_groups":[false],"subnet_mapping":true,"subnets":[false,false],"tags":{},"tags_all":{},"vpc_id":true,"zone_id":true},"before_sensitive":false,"after_sensitive":{"access_logs":[],"connection_logs":[],"security_groups":[false],"subnet_mapping":[],"subnets":[false,false],"tags":{},"tags_all":{}}}},{"address":"module.alb.aws_lb_listener.alb_listener","module_address":"module.alb","mode":"managed","type":"aws_lb_listener","name":"alb_listener","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"alpn_policy":null,"certificate_arn":null,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[],"type":"forward"}],"port":80,"protocol":"HTTP","tags":null,"timeouts":null},"after_unknown":{"arn":true,"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"order":true,"redirect":[],"target_group_arn":true}],"id":true,"load_balancer_arn":true,"mutual_authentication":true,"ssl_policy":true,"tags_all":true},"before_sensitive":false,"after_sensitive":{"default_action":[{"authenticate_cognito":[],"authenticate_oidc":[],"fixed_response":[],"forward":[],"redirect":[]}],"mutual_authentication":[],"tags_all":{}}}},{"address":"module.alb.aws_lb_target_group.alb_target_group","module_address":"module.alb","mode":"managed","type":"aws_lb_target_group","name":"alb_target_group","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"deregistration_delay":"300","health_check":[{"enabled":true,"healthy_threshold":3,"interval":30,"path":"/health","port":"traffic-port","protocol":"HTTP","timeout":5,"unhealthy_threshold":3}],"lambda_multi_value_headers_enabled":false,"name":"om-dev-us-east-1-tg","port":80,"protocol":"HTTP","proxy_protocol_v2":false,"slow_start":0,"tags":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"},"tags_all":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"},"target_type":"instance","vpc_id":"vpc-04e46565bb5e772a5"},"after_unknown":{"arn":true,"arn_suffix":true,"connection_termination":true,"health_check":[{"matcher":true}],"id":true,"ip_address_type":true,"load_balancer_arns":true,"load_balancing_algorithm_type":true,"load_balancing_anomaly_mitigation":true,"load_balancing_cross_zone_enabled":true,"name_prefix":true,"preserve_client_ip":true,"protocol_version":true,"stickiness":true,"tags":{},"tags_all":{},"target_failover":true,"target_group_health":true,"target_health_state":true},"before_sensitive":false,"after_sensitive":{"health_check":[{}],"load_balancer_arns":[],"stickiness":[],"tags":{},"tags_all":{},"target_failover":[],"target_group_health":[],"target_health_state":[]}}},{"address":"module.alb.aws_lb_target_group_attachment.alb_target_group_attachment","module_address":"module.alb","mode":"managed","type":"aws_lb_target_group_attachment","name":"alb_target_group_attachment","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"availability_zone":null,"port":80},"after_unknown":{"id":true,"target_group_arn":true,"target_id":true},"before_sensitive":false,"after_sensitive":{}}},{"address":"module.web_instance_asg.aws_autoscaling_group.web_asg","module_address":"module.web_instance_asg","mode":"managed","type":"aws_autoscaling_group","name":"web_asg","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"capacity_rebalance":null,"context":null,"default_instance_warmup":null,"desired_capacity":1,"desired_capacity_type":null,"enabled_metrics":null,"force_delete":false,"force_delete_warm_pool":false,"health_check_grace_period":300,"ignore_failed_scaling_activities":false,"initial_lifecycle_hook":[],"instance_maintenance_policy":[],"instance_refresh":[],"launch_configuration":null,"launch_template":[{"version":"$Latest"}],"max_instance_lifetime":null,"max_size":2,"metrics_granularity":"1Minute","min_elb_capacity":null,"min_size":1,"name":"OrderManager","placement_group":null,"protect_from_scale_in":false,"suspended_processes":null,"tag":[{"key":"Environment","propagate_at_launch":true,"value":"dev"},{"key":"Name","propagate_at_launch":true,"value":"om-dev-use1-asg"},{"key":"Platform","propagate_at_launch":true,"value":"tillster"},{"key":"Purpose","propagate_at_launch":true,"value":"om"},{"key":"Service","propagate_at_launch":true,"value":"om"},{"key":"Tenant","propagate_at_launch":true,"value":"shared"}],"termination_policies":null,"timeouts":null,"vpc_zone_identifier":["subnet-022338a03b4a0dd31","subnet-02db307f14813ffd7"],"wait_for_capacity_timeout":"10m","wait_for_elb_capacity":null,"warm_pool":[]},"after_unknown":{"arn":true,"availability_zones":true,"default_cooldown":true,"health_check_type":true,"id":true,"initial_lifecycle_hook":[],"instance_maintenance_policy":[],"instance_refresh":[],"launch_template":[{"id":true,"name":true}],"load_balancers":true,"mixed_instances_policy":true,"name_prefix":true,"predicted_capacity":true,"service_linked_role_arn":true,"tag":[{},{},{},{},{},{}],"target_group_arns":true,"traffic_source":true,"vpc_zone_identifier":[false,false],"warm_pool":[],"warm_pool_size":true},"before_sensitive":false,"after_sensitive":{"availability_zones":[],"initial_lifecycle_hook":[],"instance_maintenance_policy":[],"instance_refresh":[],"launch_template":[{}],"load_balancers":[],"mixed_instances_policy":[],"tag":[{},{},{},{},{},{}],"target_group_arns":[],"traffic_source":[],"vpc_zone_identifier":[false,false],"warm_pool":[]}}},{"address":"module.web_instance_asg.aws_autoscaling_policy.scale_in_policy","module_address":"module.web_instance_asg","mode":"managed","type":"aws_autoscaling_policy","name":"scale_in_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"adjustment_type":"ChangeInCapacity","autoscaling_group_name":"OrderManager","cooldown":null,"enabled":true,"estimated_instance_warmup":null,"min_adjustment_magnitude":null,"name":"scale-in-policy","policy_type":"SimpleScaling","predictive_scaling_configuration":[],"scaling_adjustment":-1,"step_adjustment":[],"target_tracking_configuration":[]},"after_unknown":{"arn":true,"id":true,"metric_aggregation_type":true,"predictive_scaling_configuration":[],"step_adjustment":[],"target_tracking_configuration":[]},"before_sensitive":false,"after_sensitive":{"predictive_scaling_configuration":[],"step_adjustment":[],"target_tracking_configuration":[]}}},{"address":"module.web_instance_asg.aws_autoscaling_policy.scale_out_policy","module_address":"module.web_instance_asg","mode":"managed","type":"aws_autoscaling_policy","name":"scale_out_policy","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"adjustment_type":"ChangeInCapacity","autoscaling_group_name":"OrderManager","cooldown":null,"enabled":true,"estimated_instance_warmup":null,"min_adjustment_magnitude":null,"name":"scale-out-policy","policy_type":"SimpleScaling","predictive_scaling_configuration":[],"scaling_adjustment":1,"step_adjustment":[],"target_tracking_configuration":[]},"after_unknown":{"arn":true,"id":true,"metric_aggregation_type":true,"predictive_scaling_configuration":[],"step_adjustment":[],"target_tracking_configuration":[]},"before_sensitive":false,"after_sensitive":{"predictive_scaling_configuration":[],"step_adjustment":[],"target_tracking_configuration":[]}}},{"address":"module.web_instance_asg.aws_cloudwatch_metric_alarm.cpu_scale_in_alarm","module_address":"module.web_instance_asg","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"cpu_scale_in_alarm","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_description":null,"alarm_name":"cpu-scale-in-alarm","comparison_operator":"LessThanThreshold","datapoints_to_alarm":null,"dimensions":{"AutoScalingGroupName":"OrderManager"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"CPUUtilization","metric_query":[],"namespace":"AWS/EC2","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":60,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":true,"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true},"before_sensitive":false,"after_sensitive":{"alarm_actions":[],"dimensions":{},"metric_query":[],"tags_all":{}}}},{"address":"module.web_instance_asg.aws_cloudwatch_metric_alarm.cpu_scale_out_alarm","module_address":"module.web_instance_asg","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"cpu_scale_out_alarm","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"actions_enabled":true,"alarm_description":null,"alarm_name":"cpu-scale-out-alarm","comparison_operator":"GreaterThanThreshold","datapoints_to_alarm":null,"dimensions":{"AutoScalingGroupName":"OrderManager"},"evaluation_periods":2,"extended_statistic":null,"insufficient_data_actions":null,"metric_name":"CPUUtilization","metric_query":[],"namespace":"AWS/EC2","ok_actions":null,"period":120,"statistic":"Average","tags":null,"threshold":80,"threshold_metric_id":null,"treat_missing_data":"missing","unit":null},"after_unknown":{"alarm_actions":true,"arn":true,"dimensions":{},"evaluate_low_sample_count_percentiles":true,"id":true,"metric_query":[],"tags_all":true},"before_sensitive":false,"after_sensitive":{"alarm_actions":[],"dimensions":{},"metric_query":[],"tags_all":{}}}},{"address":"module.web_instance_asg.aws_launch_template.web_instance_launch_template","module_address":"module.web_instance_asg","mode":"managed","type":"aws_launch_template","name":"web_instance_launch_template","provider_name":"registry.terraform.io/hashicorp/aws","change":{"actions":["create"],"before":null,"after":{"block_device_mappings":[],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"description":null,"disable_api_stop":null,"disable_api_termination":null,"ebs_optimized":null,"elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[],"image_id":"ami-0562851c7c2f478c5","instance_initiated_shutdown_behavior":null,"instance_market_options":[],"instance_requirements":[],"instance_type":"t3.medium","kernel_id":null,"key_name":"tillster-dev-us-east-1-keypair","license_specification":[],"maintenance_options":[],"monitoring":[],"name_prefix":"OrderManager-ASG","network_interfaces":[{"associate_carrier_ip_address":null,"associate_public_ip_address":"false","delete_on_termination":null,"description":null,"device_index":null,"interface_type":null,"ipv4_address_count":null,"ipv4_addresses":null,"ipv4_prefix_count":null,"ipv4_prefixes":null,"ipv6_address_count":null,"ipv6_addresses":null,"ipv6_prefix_count":null,"ipv6_prefixes":null,"network_card_index":null,"network_interface_id":null,"primary_ipv6":null,"private_ip_address":null,"security_groups":["sg-0a7d75a49414ead24"],"subnet_id":null}],"placement":[],"private_dns_name_options":[],"ram_disk_id":null,"security_group_names":null,"tag_specifications":[{"resource_type":"instance","tags":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"}}],"tags":null,"update_default_version":null,"user_data":null,"vpc_security_group_ids":null},"after_unknown":{"arn":true,"block_device_mappings":[],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"default_version":true,"elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[],"id":true,"instance_market_options":[],"instance_requirements":[],"latest_version":true,"license_specification":[],"maintenance_options":[],"metadata_options":true,"monitoring":[],"name":true,"network_interfaces":[{"security_groups":[false]}],"placement":[],"private_dns_name_options":[],"tag_specifications":[{"tags":{}}],"tags_all":true},"before_sensitive":false,"after_sensitive":{"block_device_mappings":[],"capacity_reservation_specification":[],"cpu_options":[],"credit_specification":[],"elastic_gpu_specifications":[],"elastic_inference_accelerator":[],"enclave_options":[],"hibernation_options":[],"iam_instance_profile":[],"instance_market_options":[],"instance_requirements":[],"license_specification":[],"maintenance_options":[],"metadata_options":[],"monitoring":[],"network_interfaces":[{"security_groups":[false]}],"placement":[],"private_dns_name_options":[],"tag_specifications":[{"tags":{}}],"tags_all":{}}}}],"configuration":{"provider_config":{"aws":{"name":"aws","full_name":"registry.terraform.io/hashicorp/aws","expressions":{"region":{"references":["var.region"]}}}},"root_module":{"module_calls":{"alb":{"source":"./modules/alb","expressions":{"alb_idle_timeout":{"references":["var.alb_idle_timeout"]},"alb_name":{"references":["var.alb_name"]},"listener_port":{"references":["var.alb_listener_port"]},"listener_protocol":{"references":["var.alb_listener_protocol"]},"subnet_id":{"references":["var.lb_public_subnet_ids"]},"tags":{"references":["var.tags"]},"target_id":{"references":["module.web_instance_asg.aws_autoscaling_group_id","module.web_instance_asg"]},"vpc_id":{"references":["var.alb_vpc_id"]},"vpc_security_group_ids":{"references":["var.lb_security_group_id"]}},"module":{"outputs":{"alb_dns_name":{"expression":{"references":["aws_lb.alb.dns_name","aws_lb.alb"]}},"alb_zone_id":{"expression":{"references":["aws_lb.alb.zone_id","aws_lb.alb"]}}},"resources":[{"address":"aws_lb.alb","mode":"managed","type":"aws_lb","name":"alb","provider_config_key":"aws","expressions":{"internal":{"constant_value":false},"load_balancer_type":{"constant_value":"application"},"name":{"references":["var.alb_name"]},"security_groups":{"references":["var.vpc_security_group_ids"]},"subnets":{"references":["var.subnet_id"]},"tags":{"references":["var.tags"]}},"schema_version":0},{"address":"aws_lb_listener.alb_listener","mode":"managed","type":"aws_lb_listener","name":"alb_listener","provider_config_key":"aws","expressions":{"default_action":[{"target_group_arn":{"references":["aws_lb_target_group.alb_target_group.arn","aws_lb_target_group.alb_target_group"]},"type":{"constant_value":"forward"}}],"load_balancer_arn":{"references":["aws_lb.alb.arn","aws_lb.alb"]},"port":{"references":["var.listener_port"]},"protocol":{"references":["var.listener_protocol"]}},"schema_version":0},{"address":"aws_lb_target_group.alb_target_group","mode":"managed","type":"aws_lb_target_group","name":"alb_target_group","provider_config_key":"aws","expressions":{"health_check":[{"healthy_threshold":{"constant_value":3},"interval":{"constant_value":30},"path":{"constant_value":"/health"},"port":{"constant_value":"traffic-port"},"timeout":{"constant_value":5},"unhealthy_threshold":{"constant_value":3}}],"name":{"references":["var.alb_name"]},"port":{"references":["var.listener_port"]},"protocol":{"references":["var.listener_protocol"]},"tags":{"references":["var.tags"]},"target_type":{"constant_value":"instance"},"vpc_id":{"references":["var.vpc_id"]}},"schema_version":0},{"address":"aws_lb_target_group_attachment.alb_target_group_attachment","mode":"managed","type":"aws_lb_target_group_attachment","name":"alb_target_group_attachment","provider_config_key":"aws","expressions":{"port":{"references":["var.listener_port"]},"target_group_arn":{"references":["aws_lb_target_group.alb_target_group.arn","aws_lb_target_group.alb_target_group"]},"target_id":{"references":["var.target_id"]}},"schema_version":0}],"variables":{"alb_idle_timeout":{"default":600,"description":"Idle timeout for the ALB in seconds"},"alb_name":{"description":"Name of the Application Load Balancer"},"listener_port":{"description":"Port on which the ALB will listen"},"listener_protocol":{"description":"Protocol for the ALB listener (e.g., HTTP, HTTPS)"},"subnet_id":{"description":"List of subnet IDs where the ALB will be deployed"},"tags":{"description":"A map of tags to add to all resources"},"target_id":{"description":"Target group ID for the ALB to route traffic to"},"vpc_id":{"description":"VPC ID where the ALB will be deployed"},"vpc_security_group_ids":{"description":"List of security group IDs for the ALB"}}}},"web_instance_asg":{"source":"./modules/asg","expressions":{"asg_group_cpu_scale_in_threshold_percentage":{"references":["var.web_instance_asg_group_cpu_scale_in_threshold_precentage"]},"asg_group_cpu_scale_out_threshold_percentage":{"references":["var.web_instance_asg_group_cpu_scale_out_threshold_precentage"]},"asg_group_vpc_zone_identifier":{"references":["var.web_private_subnet_ids"]},"asg_instance_scaling_adjustment":{"references":["var.web_instance_scaling_adjustment"]},"asg_max_instance_size":{"references":["var.web_instance_asg_max_instance_size"]},"asg_min_instance_size":{"references":["var.web_instance_asg_min_instance_size"]},"asg_web_instance_name":{"references":["var.asg_web_instance_name"]},"aws_autoscaling_group_name":{"references":["var.aws_autoscaling_group_name"]},"aws_launch_template_image_id":{"references":["var.web_instance_ami"]},"aws_launch_template_instance_type":{"references":["var.web_instance_type"]},"aws_launch_template_key_name":{"references":["var.aws_ssh_key_pair"]},"aws_launch_template_name":{"references":["var.web_instance_launch_template_name"]},"aws_launch_template_security_group":{"references":["var.web_security_group_id"]},"tags":{"references":["var.tags"]}},"module":{"outputs":{"aws_autoscaling_group_id":{"expression":{"references":["aws_autoscaling_group.web_asg.id","aws_autoscaling_group.web_asg"]}}},"resources":[{"address":"aws_autoscaling_group.web_asg","mode":"managed","type":"aws_autoscaling_group","name":"web_asg","provider_config_key":"aws","expressions":{"desired_capacity":{"references":["var.asg_min_instance_size"]},"launch_template":[{"id":{"references":["aws_launch_template.web_instance_launch_template.id","aws_launch_template.web_instance_launch_template"]},"version":{"constant_value":"$Latest"}}],"max_size":{"references":["var.asg_max_instance_size"]},"min_size":{"references":["var.asg_min_instance_size"]},"name":{"references":["var.aws_autoscaling_group_name"]},"tag":[{"key":{"constant_value":"Name"},"propagate_at_launch":{"constant_value":true},"value":{"references":["var.asg_web_instance_name"]}}],"vpc_zone_identifier":{"references":["var.asg_group_vpc_zone_identifier"]}},"schema_version":1},{"address":"aws_autoscaling_policy.scale_in_policy","mode":"managed","type":"aws_autoscaling_policy","name":"scale_in_policy","provider_config_key":"aws","expressions":{"adjustment_type":{"constant_value":"ChangeInCapacity"},"autoscaling_group_name":{"references":["aws_autoscaling_group.web_asg.name","aws_autoscaling_group.web_asg"]},"name":{"constant_value":"scale-in-policy"},"scaling_adjustment":{"references":["var.asg_instance_scaling_adjustment"]}},"schema_version":0},{"address":"aws_autoscaling_policy.scale_out_policy","mode":"managed","type":"aws_autoscaling_policy","name":"scale_out_policy","provider_config_key":"aws","expressions":{"adjustment_type":{"constant_value":"ChangeInCapacity"},"autoscaling_group_name":{"references":["aws_autoscaling_group.web_asg.name","aws_autoscaling_group.web_asg"]},"name":{"constant_value":"scale-out-policy"},"scaling_adjustment":{"references":["var.asg_instance_scaling_adjustment"]}},"schema_version":0},{"address":"aws_cloudwatch_metric_alarm.cpu_scale_in_alarm","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"cpu_scale_in_alarm","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_autoscaling_policy.scale_in_policy.arn","aws_autoscaling_policy.scale_in_policy"]},"alarm_name":{"constant_value":"cpu-scale-in-alarm"},"comparison_operator":{"constant_value":"LessThanThreshold"},"dimensions":{"references":["aws_autoscaling_group.web_asg.name","aws_autoscaling_group.web_asg"]},"evaluation_periods":{"constant_value":2},"metric_name":{"constant_value":"CPUUtilization"},"namespace":{"constant_value":"AWS/EC2"},"period":{"constant_value":120},"statistic":{"constant_value":"Average"},"threshold":{"references":["var.asg_group_cpu_scale_in_threshold_percentage"]}},"schema_version":1},{"address":"aws_cloudwatch_metric_alarm.cpu_scale_out_alarm","mode":"managed","type":"aws_cloudwatch_metric_alarm","name":"cpu_scale_out_alarm","provider_config_key":"aws","expressions":{"alarm_actions":{"references":["aws_autoscaling_policy.scale_out_policy.arn","aws_autoscaling_policy.scale_out_policy"]},"alarm_name":{"constant_value":"cpu-scale-out-alarm"},"comparison_operator":{"constant_value":"GreaterThanThreshold"},"dimensions":{"references":["aws_autoscaling_group.web_asg.name","aws_autoscaling_group.web_asg"]},"evaluation_periods":{"constant_value":2},"metric_name":{"constant_value":"CPUUtilization"},"namespace":{"constant_value":"AWS/EC2"},"period":{"constant_value":120},"statistic":{"constant_value":"Average"},"threshold":{"references":["var.asg_group_cpu_scale_out_threshold_percentage"]}},"schema_version":1},{"address":"aws_launch_template.web_instance_launch_template","mode":"managed","type":"aws_launch_template","name":"web_instance_launch_template","provider_config_key":"aws","expressions":{"image_id":{"references":["var.aws_launch_template_image_id"]},"instance_type":{"references":["var.aws_launch_template_instance_type"]},"key_name":{"references":["var.aws_launch_template_key_name"]},"name_prefix":{"references":["var.aws_launch_template_name"]},"network_interfaces":[{"associate_public_ip_address":{"constant_value":false},"security_groups":{"references":["var.aws_launch_template_security_group"]}}],"tag_specifications":[{"resource_type":{"constant_value":"instance"},"tags":{"references":["var.tags"]}}]},"schema_version":0}],"variables":{"asg_group_cpu_scale_in_threshold_percentage":{"description":"ASG CPU scale-in threshold percentage"},"asg_group_cpu_scale_out_threshold_percentage":{"description":"ASG CPU scale-out threshold percentage"},"asg_group_vpc_zone_identifier":{"description":"List of VPC subnet IDs for ASG"},"asg_instance_scaling_adjustment":{"description":"Number of instances to scale in or out"},"asg_max_instance_size":{"description":"Maximum number of instances for ASG"},"asg_min_instance_size":{"description":"Minimum number of instances for ASG"},"asg_web_instance_name":{"description":"Name tag for the ASG instances"},"aws_autoscaling_group_enabled_metrics":{"default":["GroupMinSize","GroupMaxSize","GroupDesiredCapacity","GroupInServiceInstances","GroupTotalInstances"],"description":"List of AWS autoscaling group enabled metrics"},"aws_autoscaling_group_metrics_granularity":{"default":"1Minute","description":"Granularity of the AWS autoscaling group metrics"},"aws_autoscaling_group_name":{"description":"Name of the Auto Scaling group"},"aws_launch_template_associate_public_ip":{"default":false,"description":"Whether to associate a public IP with the instance"},"aws_launch_template_image_id":{"description":"AMI ID for the EC2 instances"},"aws_launch_template_instance_type":{"description":"EC2 instance type"},"aws_launch_template_key_name":{"description":"SSH key pair name for EC2 access"},"aws_launch_template_name":{"description":"Name of the AWS launch template"},"aws_launch_template_security_group":{"description":"List of security groups for the launch template"},"region":{"default":"eu-west-1","description":"AWS region"},"tags":{"description":"A map of tags to add to all resources"}}}}},"variables":{"alb_idle_timeout":{"default":600,"description":"ALB idle timeout"},"alb_listener_port":{"description":"ALB listener port"},"alb_listener_protocol":{"description":"ALB listener protocol"},"alb_name":{"description":"Name of application load balancer"},"alb_vpc_id":{"description":"ALB VPC Id"},"asg_web_instance_name":{"description":"ASG web instance name"},"aws_autoscaling_group_name":{"description":"AWS autoscaling group name"},"aws_ssh_key_pair":{"description":"AWS SSH key pair"},"lb_public_subnet_ids":{"description":"LB private subnet ids"},"lb_security_group_id":{"description":"LB security group ids"},"region":{"default":"us-east-1","description":"AWS region"},"tags":{"default":{"Environment":"dev","Platform":"tillster","Purpose":"om","Service":"om","Tenant":"shared"},"description":"A map of tags to add to all resources"},"web_instance_ami":{"description":"Web instance ami"},"web_instance_asg_group_cpu_scale_in_threshold_precentage":{"default":60,"description":"ASG scaling group CPU scale-in threshold percentage"},"web_instance_asg_group_cpu_scale_out_threshold_precentage":{"default":80,"description":"ASG scaling group CPU scale-out threshold percentage"},"web_instance_asg_max_instance_size":{"default":2,"description":"ASG max instance size"},"web_instance_asg_min_instance_size":{"default":1,"description":"ASG min instance size"},"web_instance_launch_template_name":{"description":"Web instance launch template name"},"web_instance_scaling_adjustment":{"default":1,"description":"Number of instances by which to scale"},"web_instance_type":{"default":"t3.medium","description":"Web instance type"},"web_private_subnet_ids":{"description":"Web private subnet ids"},"web_security_group_id":{"description":"Web Security Group id"}}}},"relevant_attributes":[{"resource":"module.web_instance_asg.aws_autoscaling_policy.scale_out_policy","attribute":["arn"]},{"resource":"module.alb.aws_lb.alb","attribute":["dns_name"]},{"resource":"module.alb.aws_lb.alb","attribute":["arn"]},{"resource":"module.web_instance_asg.aws_launch_template.web_instance_launch_template","attribute":["id"]},{"resource":"module.web_instance_asg.aws_autoscaling_policy.scale_in_policy","attribute":["arn"]},{"resource":"module.web_instance_asg.aws_autoscaling_group.web_asg","attribute":["id"]},{"resource":"module.alb.aws_lb_target_group.alb_target_group","attribute":["arn"]},{"resource":"module.web_instance_asg.aws_autoscaling_group.web_asg","attribute":["name"]},{"resource":"module.alb.aws_lb.alb","attribute":["zone_id"]}],"timestamp":"2024-09-29T16:21:38Z","applyable":true,"complete":true,"errored":false}
